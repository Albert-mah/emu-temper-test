// ==UserScript==
// @name         albert_test1
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  emu测试用脚本
// @author       Albert
// @match        http://console.emusprint.com/*
// @match        http://console.doubletick.ink/*
// @match        http://console.apexmobi.site/*
// @match        http://console.powermob.top/*
// @match        http://console.snowywin.com/*
// @match        http://console.fortunecatclick.com/*
// @match        http://console.viloonmobi.com/*
// @match        http://console.innermobi.com/*
// @match        https://console.novabeyond.com/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=tampermonkey.net
// @grant        none
// @run-at       document-end
// ==/UserScript==



(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=Vue;var n=e.n(t),o=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"menu_drag"}},[t("el-dropdown",[t("el-button",{staticStyle:{"font-size":"30px",padding:"10px"},attrs:{type:"primary",icon:"el-icon-menu",circle:""}}),e._v(" "),t("el-dropdown-menu",{scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-dropdown-item",[t("confirm-menu")],1),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.test_dialog.apply(null,arguments)}}},[e._v("测试")])]}}])})],1)],1)};o._withStripped=!0;var r=function(){var e=this,t=e._self._c;return t("el-dropdown",[t("span",{on:{click:function(t){return t.stopPropagation(),e.gen_aff_list.apply(null,arguments)}}},[e._v("批单")]),e._v(" "),t("el-dropdown-menu",{scopedSlots:e._u([{key:"default",fn:function(n){return e._l(e.options,(function(n){return t("el-dropdown-item",{key:n.id,nativeOn:{click:function(t){return e.confirm_offer([n.id])}}},[e._v("\n    "+e._s(`${n.id} - ${n.company}`)+" ")])}))}}])})],1)};async function a(e,t){const n=`${window.location.protocol}//${window.location.host}`+t;try{const t=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","access-control-allow-origin":"*"},body:JSON.stringify(e)});return await t.json()}catch(e){throw console.error("Error: ",e),e}}function i(e){var t=document.querySelectorAll("label.el-form-item__label");for(var n of t)if(n.textContent.trim()===e){var o=n.closest(".el-form-item").querySelector("input.el-input__inner");if(o)return o.value}return!1}function l(e,t,n,o,r,a,i,l){var s,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),o&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),i?(s=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=s):r&&(s=l?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(c.functional){c._injectStyles=s;var d=c.render;c.render=function(e,t){return s.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,s):[s]}return{exports:e,options:c}}r._withStripped=!0;var s=l({data:()=>({dialogVisible:!1,selectedOption:"",options:[]}),mounted(){(async()=>{await this.gen_aff_list()})()},methods:{async gen_aff_list(){try{this.options=await async function(){try{const e=await a({page:{page:1,rows:1e4}},"/api/affiliate/affiliateList");return Array.isArray(e.data.dataList)?e.data.dataList:(alert("err err"),[])}catch(e){return[]}}()}catch(e){console.error("从API加载数据失败",e)}},async confirm_offer(e){var t=i("OfferId"),n=i("Status");t?n?"active"===n?confirm("您确定要确认批单吗？单号："+t)&&await async function(e,t){var n={data:{affiliateIds:e,cap:null,payout:null,rate:null,payoutPercent:null,dailyCap:null,clickCap:null,offerId:t.join(",")}};await a(n,"/api/affiliate/addAffOfferWhitelistRecord")}(e,[t]):alert("无法批单，单子状态为"+n):alert("批单失败，找不到状态"):alert("批单失败，找不到单号")}}},r,[],!1,null,null,null);const c=l({components:{confirmMenu:s.exports},data:()=>({x:0,y:0,left:100,top:100}),mounted(){this.makeDraggable()},methods:{test_dialog(){alert("waiting....")},makeDraggable(){const e=document.querySelector("#menu_drag");let t=!1,n=0,o=0;const r=r=>{t&&(e.style.position="absolute",e.style.left=r.pageX-n+"px",e.style.top=r.pageY-o+"px")},a=()=>{t=!1,document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",a)};e.addEventListener("mousedown",(i=>{t=!0,n=i.pageX-e.offsetLeft,o=i.pageY-e.offsetTop,document.addEventListener("mousemove",r),document.addEventListener("mouseup",a)}))}}},o,[],!1,null,null,null).exports,d=ELEMENT;var u=e.n(d),p=document.createElement("div");p.style.position="fixed",p.style.bottom="20px",p.style.right="20px",p.style.zIndex="1000",p.style.width="150px",p.style.height="150px";const f=document.createElement("div");f.id="plugin-app",p.appendChild(f),document.body.appendChild(p),n().use(u()),new(n())({el:"#plugin-app",components:{MenuComponent:c},template:"<MenuComponent/>"})})();
